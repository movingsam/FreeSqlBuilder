 @using FreeSqlBuilder.Core
@using FreeSqlBuilder.TemplateEngine.Utilities
@model FreeSqlBuilder.TemplateEngine.BuildTask
@{
    Layout = "_Layout.cshtml";
    var project = Model.Project;
    var table = Model.CurrentTable;
    var navigates = Model.GetNavigates();
}

@functions
{

    string GetDto(Project project,string tableName)
    {
        return project.GetBuilder("Dtos").GetName(tableName);
    }
    string GetPostDataDto(Project project,string tableName)
    {
        return project.GetBuilder("PostDataDto").GetName(tableName);
    }
    string GetPageViewDto(Project project,string tableName)
    {
        return project.GetBuilder("PageViewDto").GetName(tableName);
    }
    string GetPagedDto(Project project,string tableName)
    {
        return project.GetBuilder("PagedDtos").GetName(tableName);
    }

}

using SFast.Infrastructure.Services;
using System.Threading.Tasks;
using System.Collections.Generic;
using @(project.ProjectInfo.ProjectName).@("Dtos.{TableName}".Replace("{TableName}",table.CsName));
@foreach (var navigate in navigates)
    {  
@:using @(project.ProjectInfo.ProjectName).@("Dtos.{TableName}".Replace("{TableName}",navigate.Value.CsName));
    }
@table.GetNameSpaceUsing()

namespace @(project.ProjectInfo.ProjectName).@(Model.CurrentBuilder.ReplaceTablePath(table.CsName).Replace("/","."))
{
    @($"{table.Comment}服务接口".GetCSharpSummary())
    public interface @(Model.CurrentBuilder.GetName(table.CsName)) : IServiceBase
    {
    @(Html.NewLine("#region 主表相关增删改查"))
    @Html.PadLeft(4)@($"{table.Comment}分页查询".GetCSharpSummary())
    @Html.PadLeft(4)Task<@(GetPageViewDto(project,table.CsName))>Query@(table.CsName)Page (@GetPagedDto(project,table.CsName) dto);
    @Html.PadLeft(4)@($"{table.Comment}新增".GetCSharpSummary())
    @Html.PadLeft(4)Task<@("bool")>Add@(table.CsName) (@GetPostDataDto(project,table.CsName) dto);
    @Html.PadLeft(4)@($"{table.Comment}修改".GetCSharpSummary())
    @Html.PadLeft(4)Task<@("bool")>Update@(table.CsName) (@GetPostDataDto(project,table.CsName) dto);
    @Html.PadLeft(4)@($"{table.Comment}删除".GetCSharpSummary())
    @Html.PadLeft(4)Task<@("bool")> Delete@(table.CsName)(List<@table.GetPrimarysName()> ids);
    @Html.PadLeft(4)@($"{table.Comment}查询".GetCSharpSummary())
    @Html.PadLeft(4)Task<@(GetDto(project,table.CsName))> Get@(table.CsName) (@table.GetPrimarysName() id);

@(Html.NewLine("#endregion"))
@(Html.NewLine("#region 导航属性相关信息"))
    
    @foreach (var navigate in navigates)
    {
       if(navigate.Value.CsName != table.CsName) { 
        @(Html.NewLine($"#region {navigate.Value.Comment}相关"))
        @($"{navigate.Value.Comment}分页查询".GetCSharpSummary())
        @Html.NewLine()
        @:Task<@GetPageViewDto(project, navigate.Value.CsName)> Query@(navigate.Value.CsName)Page (@GetPagedDto(project, navigate.Value.CsName)  dto);
        @($"{navigate.Value.Comment}新增".GetCSharpSummary())
        @Html.NewLine()
        @:Task<bool> Add@(navigate.Value.CsName) ( @GetPostDataDto(project, navigate.Value.CsName) dto);
        @($"{navigate.Value.Comment}修改".GetCSharpSummary())
        @Html.NewLine()
        @:Task<bool> Update@(navigate.Value.CsName) ( @GetPostDataDto(project, navigate.Value.CsName) dto);
        @($"{navigate.Value.Comment}删除".GetCSharpSummary())
        @Html.NewLine()
        @:Task<bool> Delete@(navigate.Value.CsName) (List<@navigate.Value.GetPrimarysName()> id);    
        @($"{navigate.Value.Comment}查询".GetCSharpSummary())
        @:Task<@(GetDto(project,navigate.Value.CsName))> Get@(navigate.Value.CsName) (@navigate.Value.GetPrimarysName() id);
        @(Html.NewLine("#endregion"))
        }
    }
@(Html.NewLine("#endregion"))
    }
}